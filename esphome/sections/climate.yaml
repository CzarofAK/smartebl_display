# ============================================
# SmartEBL Display - Climate Section
# ============================================
# Template for climate systems (heating, AC, ventilation)
#
# Import in your main.yaml:
#   packages:
#     climate: github://CzarofAK/smartebl_display/esphome/sections/climate.yaml@main

# ============================================
# TEMPLATE - CUSTOMIZATION REQUIRED!
# ============================================

# ============================================
# TEMPERATURES
# ============================================

sensor:
  # Interior Temperature
  - platform: homeassistant
    id: temperature_inside
    entity_id: sensor.interior_temperature  # ← CUSTOMIZE
    name: "Temperature Inside"
    unit_of_measurement: "°C"
    on_value:
      then:
        - lambda: |-
            char buffer[10];
            snprintf(buffer, sizeof(buffer), "%.1f°C", x);
            id(nextion_display).set_component_text("temp_inside", buffer);

  # Exterior Temperature
  - platform: homeassistant
    id: temperature_outside
    entity_id: sensor.exterior_temperature  # ← CUSTOMIZE
    name: "Temperature Outside"
    unit_of_measurement: "°C"
    on_value:
      then:
        - lambda: |-
            char buffer[10];
            snprintf(buffer, sizeof(buffer), "%.1f°C", x);
            id(nextion_display).set_component_text("temp_outside", buffer);

  # Humidity
  - platform: homeassistant
    id: humidity_inside
    entity_id: sensor.interior_humidity  # ← CUSTOMIZE
    name: "Humidity"
    unit_of_measurement: "%"
    on_value:
      then:
        - lambda: |-
            char buffer[10];
            snprintf(buffer, sizeof(buffer), "%.0f%%", x);
            id(nextion_display).set_component_text("humidity", buffer);

            // Color: Red if too humid (> 70%)
            int color = (x > 70) ? 63488 : 2016;
            id(nextion_display).set_component_value("humidity.pco", color);

# ============================================
# HEATING
# ============================================

climate:
  # Heater (Climate Entity)
  - platform: homeassistant
    id: heater
    entity_id: climate.heater  # ← CUSTOMIZE

binary_sensor:
  # Heater Active
  - platform: homeassistant
    id: heater_active
    entity_id: binary_sensor.heater_active  # ← CUSTOMIZE
    on_press:
      then:
        - lambda: |-
            id(nextion_display).set_component_text("heater_status", "Heating");
            id(nextion_display).set_component_value("heater_status.pco", 64512);  // Orange
    on_release:
      then:
        - lambda: |-
            id(nextion_display).set_component_text("heater_status", "Off");
            id(nextion_display).set_component_value("heater_status.pco", 50712);  // Gray

# ============================================
# AC / VENTILATION
# ============================================

switch:
  # Ventilation Fan
  - platform: homeassistant
    id: ventilation
    entity_id: switch.ventilation  # ← CUSTOMIZE

# ============================================
# NEXTION COMPONENTS (Reference)
# ============================================
#
# Required on Climate_1 Page:
# - Text "temp_inside"     → Interior Temperature
# - Text "temp_outside"    → Exterior Temperature
# - Text "humidity"        → Humidity
# - Text "heater_status"   → Heater Status
#
# Optional on Climate_2:
# - Slider "heater_target" → Target Temperature
# - Button "btn_vent"      → Ventilation On/Off

# ============================================
# CUSTOMIZATION NOTES
# ============================================
#
# 1. Replace all entity_id with your Home Assistant Entities
# 2. Add AC if available
# 3. Optional: Add control for temperature setpoint
# 4. Optional: Ventilation speed control
